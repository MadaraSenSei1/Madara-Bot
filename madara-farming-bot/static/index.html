
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Travian Farming Bot</title>
    <script>
        let username = "";

        async function login() {
            const formData = new FormData(document.getElementById("loginForm"));
            const response = await fetch("/login", {
                method: "POST",
                body: formData,
            });
            const result = await response.json();
            if (result.message) {
                username = formData.get("username");
                document.getElementById("loginSection").style.display = "none";
                document.getElementById("dashboard").style.display = "block";
                document.getElementById("loginStatus").innerText = "Logged in as: " + username;
                refreshFarmLists();
            } else {
                alert("Login failed.");
            }
        }

        async function refreshFarmLists() {
            const response = await fetch(`/farmlist?username=${username}`);
            const result = await response.json();
            const farmLists = document.getElementById("farmLists");
            farmLists.innerHTML = "";
            if (result.farms && result.farms.length > 0) {
                result.farms.forEach(farm => {
                    const li = document.createElement("li");
                    li.innerText = farm;
                    farmLists.appendChild(li);
                });
            } else {
                const li = document.createElement("li");
                li.innerText = "Failed to load farm lists.";
                farmLists.appendChild(li);
            }
        }

        async function startBot() {
            const formData = new FormData();
            formData.append("username", username);
            formData.append("interval_min", document.getElementById("interval_min").value);
            formData.append("interval_max", document.getElementById("interval_max").value);

            const response = await fetch("/start-bot", {
                method: "POST",
                body: formData,
            });
            const result = await response.json();
            alert(result.message || "Bot started.");
        }
    </script>
</head>
<body>
    <div id="loginSection">
        <h2>Travian Farming Bot â€“ Login</h2>
        <form id="loginForm" onsubmit="event.preventDefault(); login();">
            <label>Username:</label><br>
            <input type="text" name="username" required><br>
            <label>Password:</label><br>
            <input type="password" name="password" required><br>
            <label>Server URL:</label><br>
            <input type="text" name="server_url" required><br>
            <label>Proxy IP:</label><br>
            <input type="text" name="proxy_ip"><br>
            <label>Proxy Port:</label><br>
            <input type="text" name="proxy_port"><br>
            <label>Proxy Username:</label><br>
            <input type="text" name="proxy_user"><br>
            <label>Proxy Password:</label><br>
            <input type="text" name="proxy_pass"><br><br>
            <button type="submit">Login</button>
        </form>
    </div>

    <div id="dashboard" style="display:none;">
        <h3>Farm Bot Dashboard</h3>
        <div id="loginStatus"></div>
        <label>Minimum Interval (minutes):</label><br>
        <input type="number" id="interval_min" value="10"><br>
        <label>Maximum Interval (minutes):</label><br>
        <input type="number" id="interval_max" value="15"><br>
        <p>+ Random Delay: 0â€“30 seconds</p>
        <button onclick="startBot()">â–¶ Start Bot</button><br><br>
        <button onclick="refreshFarmLists()">ðŸ”„ Refresh Farm Lists</button>
        <h4>Available Farm Lists</h4>
        <ul id="farmLists"></ul>
    </div>
</body>
</html>
